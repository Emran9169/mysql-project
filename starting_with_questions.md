Answer the following questions and provide the SQL queries used to find the answer.

    
**Question 1: Which cities and countries have the highest level of transaction revenues on the site?**

SQL Queries:
SELECT
  country,
  city,
  SUM(totaltransactionrevenue) AS total_revenue
FROM
  all_sessions
WHERE
  totaltransactionrevenue IS NOT NULL
GROUP BY
  city, country
ORDER BY
  total_revenue

Answer:
When executing the provided code, the data output indicates that Swizerland, Zurich has the highest total transaction revenues. However, it's crucial to note that a substantial portion of the transaction revenue data is missing, rendering the comparison of the highest transaction revenues inadequate due to insufficient data. As we can see from the data output area United States is the country that is mentioned multiple times, if the total transaction revenue was only by country, United States would be the one with the highest level of total transaction revenues, but as we need to group it also by city then Swizerland and zurich are the country and the city with the most amount of total transactionrevenue generated respectively.



**Question 2: What is the average number of products ordered from visitors in each city and country?**


SQL Queries:
SELECT
  AVG(total_ordered) AS avg_ordered_quantity,
  CASE
    WHEN city = '(not set)' OR city = 'not available in demo dataset' THEN NULL
    ELSE city
  END AS city,
  country
FROM
  sales_by_sku 
JOIN
  all_sessions ON sales_by_sku.productsku = all_sessions.productsku
GROUP BY
  country, city
ORDER BY
  avg_ordered_quantity desc
Answer:





**Question 3: Is there any pattern in the types (product categories) of products ordered from visitors in each city and country?**


SQL Queries:
SELECT
    productname,
    country,
    city
FROM
    (
        SELECT
            name AS productname,
            CASE
                WHEN city IN ('(not set)', 'not available in demo dataset') THEN NULL
                ELSE city
            END AS city,
            CASE
                WHEN country = '(not set)' THEN NULL
                ELSE country
            END AS country
        FROM
            products p
        JOIN
            all_sessions a ON p.sku = a.productsku
    ) AS newtable
WHERE
    city IS NOT NULL
    AND country IS NOT NULL


Answer:





**Question 4: What is the top-selling product from each city/country? Can we find any pattern worthy of noting in the products sold?**


SQL Queries:
WITH ranked_products AS (
  SELECT
   case when city = '(not set)' or city = 'not available in demo dataset' then null 
	else city end as city,
    case when country = '(not set)' then null else country end as country,
    name AS product_name,
    RANK() OVER (PARTITION BY city, country ORDER BY COUNT(*) DESC) AS product_rank
  FROM
    all_sessions a
  JOIN
    products p ON a.productsku = p.sku	
  GROUP BY
    country, city, name
)
SELECT
  city,
  country,
  product_name AS top_selling_product
FROM
  ranked_products
WHERE
  product_rank = 1 AND city IS NOT null AND country IS NOT null
ORDER BY
  country


Answer:
I was able to notice as the diversity of top-selling products across cities and countries suggests that consumer preferences may vary significantly based on local factors, cultural influences, or regional trends. the other thing i noticed is most of the top_selling product across each city as well as country is not unBuenoique, what i meant is most coutries and cities have multiple top selling products for instance United States, Atlanta has two top selling products among many products that are sold there.




**Question 5: Can we summarize the impact of revenue generated from each city/country?**

SQL Queries:

SELECT totalrevenue, city, country
FROM (
SELECT
 sum((unitprice/1000)*unitssold) as totalrevenue,
  CASE WHEN city = '(not set)' OR city = 'not available in demo dataset' THEN NULL
       ELSE city
  END AS city,
  CASE WHEN country = '(not set)' THEN NULL
       ELSE country
  END AS country
FROM
  analytics a
JOIN
  all_sessions b ON a.visitid = b.visitid
GROUP BY 
	city, country
	)
WHERE
  city IS NOT null AND country IS NOT null and totalrevenue IS NOT null
ORDER BY 
  totalrevenue desc
  
Answer:

The above code is to get the revenues generated by each countries and city. As we can see from the above code the revenue is calculated by multiplying the units price and units sold. when we execute the code we can see that United State is very dominant from the countries interms of revenue generated 



